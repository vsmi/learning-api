#  Bookstagram
Я изучаю fastAPI и Pytest, работая над этим проектом

---
## О проекте

Bookstagram - дает возможность зарегистрироваться и постить свои заметки о книгах, собирать лайки и комментарии.
Искать любые посты об интересных тебе книгах.


Используя этот проект, ты можешь потренироваться в использовании и тестировании api.
Позже я добавлю интересные задания.

Документация тут - https://legchikova.herokuapp.com/docs#/



---
## Описание методов
## User
---
### Create User - Метод регистрации пользователя

**Request**

POST
{{url}}/users

Параметры запроса (raw json)
| Параметр | Описание | Обязательность |
| --- | --- | --- |
| email | email пользователя | Да |
| password | Пароль пользователя | Да |
|  |  |  |

**Response**

- Успешная обработка запроса:    
    Код ответа - 201 Created    
    И  объект в формате json     
    ```json
    {
    "id": id, 
    "email": "email"
    }
    ```
    
- Неуспешная обработка запроса:
    - Данный пользователь уже зарегистрирован в системе        
        Код ответа - 409        
        И  объект в формате json         
        ```json
        {
        "detail": "User with this email is already registered"
        }
        ```
        
    - Не переданы обязательные параметры или переданы некорректные значения        
        Код ответа - 422        
        И  объект в формате json с указанием на ошибку

---
### Get User - Метод поиска пользователя

**Request**

GET

{{url}}/users/{{id}}

| Параметр | Описание | Обязательность | Тип |
| --- | --- | --- | --- |
| id | Уникальный идентификатор пользователя | Да | Integer |

**Response**

- Успешная обработка запроса:
    
    Код ответа - 200 Ok
    
    И  объект в формате json 
    
    ```json
    {
        "id": id,
        "email": "email"
    }
    ```
    
- Неуспешная обработка запроса:
    - Данный пользователь Не зарегистрирован в системе
        
        Код ответа - 404 Not Found
        
        И  объект в формате json 
        
        ```json
        {
        "detail": "User with id {{id}} was not found"
        }
        ```
        
    - Не переданы обязательные параметры
        
        Код ответа - 405 Method Not Allowed
        
        И  объект в формате json
        
        ```json
         {
        "detail": "Method Not Allowed"
        }
        ```
        

    - В параметре передано невалидное значение
    
        Код ответа - 422 Unprocessable Entity
    
        И  объект в формате json с указанием на ошибку

---





## Authentication

### Login User - Метод авторизации пользователя
!!! Токен авторизации действителен в течение 30 минут

**Request**

POST

{{url}}/login 

Параметры запроса (form-data)

| Параметр | Описание | Обязательность |
| --- | --- | --- |
| username  | email пользователя | Да |
| password | Пароль пользователя | Да |

**Response**

- Успешная обработка запроса:
    
    Код ответа - 200 Ок
    
    И  объект в формате json 
    
    ```json
    {
    "access_token": access_token, 
    "token_type": "bearer"
    }
    ```
    
- Неуспешная обработка запроса:
    - Данные пользователя не зарегистрированы в системе
        
        Код ответа - 404
        
        И  объект в формате json 
        
        ```json
        {
        "detail": "Invalid credentials"
        }
        ```
        
    - Не переданы обязательные параметры
        
        Код ответа - 422
        
        И  объект в формате json с указанием на отсутствующий параметр

---

## Book

### Get Books - Метод поиска книг

**Request**

GET
{{url}}/books?[limit=10]&[rating=0.0]

| Параметр | Описание | Обязательность | Тип | Значение по умолчанию |
| --- | --- | --- | --- | --- |
| limit | Количество записей для вывода пользователю | Нет | Integer | 10 |
| rating | Рэйтинг книг. Пользователь увидит список книг с рейтингом, равным или больше указанного  | Нет | Float | 0.0 |

**Response**

- Успешная обработка запроса:
    
    Код ответа - 200 Ok
    
    И  объект в формате json 
    
    ```json
    [
    {
            "title": "title",
            "author": "author",
            "rating": 0.0,
            "read": T/F,
            "id": id,
            "created_at": "datatime",
            "owner_id": id,
            "owner": {
                "id": id,
                "email": "email"
            }
        },
    {}
    ]
    ```
    
    | Поле | Описание | Тип |
    | --- | --- | --- |
    | title | Название книги | string |
    | author | Автор книги | string |
    | rating | Рейтинг книги, по мнению пользователя, запостившего эту запись | float |
    | read | Флаг: прочитана или нет книга | boolean |
    | id | Уникальный идентификатор записи о книге | integer |
    | created_at | Дата создания записи о книге | datatime |
    | owner_id | Уникальный идентификатор пользователя, запостившего книгу | integer |
    | owner_id/id | Уникальный идентификатор пользователя, запостившего книгу | integer |
    | owner_id/email | Емейл пользователя, запостившего книгу | string |

- Неуспешная обработка запроса:
    - В параметре передано невалидное значение
        
        Код ответа - 422 Unprocessable Entity
        
        И  объект в формате json с указанием на ошибку

---

### Create Book - Метод создания записи о книге

**Request**

POST
{{url}}/books

Параметры запроса (raw json)
| Параметр | Описание | Обязательность | Тип |
| --- | --- | --- | --- |
| title | Название книги | Да | string |
| author | Автор книги | Нет | string |
| rating | Рейтинг книги по мнению пользователя | Нет | float |
| read | Флаг: прочитана книга или нет | Да | boolean |

**Response**

- Успешная обработка запроса:    
    Код ответа - 201 Created    
    И  объект в формате json     
    ```json
    {
    "title": "title",
    "author": "author",
    "rating": rating,
    "read": read,    
    "id": id, 
    "created_at": "datatime",
    "owner_id": id,
    "owner": {
        "id": id,
        "email": "email"
    }
    }
    ```
    
- Неуспешная обработка запроса:
       
    - Не переданы обязательные параметры или переданы некорректные значения        
        Код ответа - 422        
        И  объект в формате json с указанием на ошибку

---

### Update Book - Метод создания записи о книге

**Request**

PUT
{{url}}/books/{{id}}

Path parameter: id - Уникальный идентификатор книги (Integer), Обязательный

Параметры запроса (raw json)
| Параметр | Описание | Обязательность | Тип |
| --- | --- | --- | --- |
| title | Название книги | Да | string |
| author | Автор книги | Нет | string |
| rating | Рейтинг книги по мнению пользователя | Нет | float |
| read | Флаг: прочитана книга или нет | Да | boolean |

**Response**

- Успешная обработка запроса:    
    Код ответа - 200 Ok    
    И  объект в формате json     
    ```json
    {
    "title": "title",
    "author": "author",
    "rating": rating,
    "read": read,    
    "id": id, 
    "created_at": "datatime",
    "owner_id": id,
    "owner": {
        "id": id,
        "email": "email"
    }
    }
    ```
    
- Неуспешная обработка запроса:
       
    - Отсутствует запись с указанным id        
        Код ответа - 404 Not Found        
        И  объект в формате json с указанием на ошибку
        ```json
        {
            "detail": "book with id {id} was not found"
        }
        ```
    - Пользователь не авторизован или токен авторизации истек
        Код ответа - 403 Forbidden        
        И  объект в формате json с указанием на ошибку
        ```json
        {
            "detail": "Not authorized to perform requested action"
        }
        ```

---

### Delete Book - Метод удаления записи о книге

**Request**

DELETE
{{url}}/books/{{id}}

Path parameter:

| Параметр | Описание | Обязательность | Тип |
| --- | --- | --- | --- |
| id | Уникальный идентификатор книги | Да | Integer |


**Response**

- Успешная обработка запроса:    
    Код ответа - 204 No Content    
    
    
- Неуспешная обработка запроса:
       
    - Отсутствует запись с указанным id        
        Код ответа - 404 Not Found        
        И  объект в формате json с указанием на ошибку
        ```json
        {
            "detail": "book with id {id} was not found"
        }
        ```
    - Пользователь не авторизован или токен авторизации истек
        Код ответа - 403 Forbidden        
        И  объект в формате json с указанием на ошибку
        ```json
        {
            "detail": "Not authorized to perform requested action"
        }
        ```
    - Не переданы обязательные параметры или переданы некорректные значения        
        Код ответа - 422        
        И  объект в формате json с указанием на ошибку

---

### Get Book - Метод поиска конкретной книги по указанному id

**Request**

GET
{{url}}/books/{{id}}

Path parameter:

| Параметр | Описание | Обязательность | Тип |
| --- | --- | --- | --- |
| id | Уникальный идентификатор книги | Да | Integer |

**Response**

- Успешная обработка запроса:
    
    Код ответа - 200 Ok
    
    И  объект в формате json 
    
    ```json
    {
            "title": "title",
            "author": "author",
            "rating": 0.0,
            "read": T/F,
            "id": id,
            "created_at": "datatime",
            "owner_id": id,
            "owner": {
                "id": id,
                "email": "email"
            }
        }
    ```
    
    | Поле | Описание | Тип |
    | --- | --- | --- |
    | title | Название книги | string |
    | author | Автор книги | string |
    | rating | Рейтинг книги, по мнению пользователя, запостившего эту запись | float |
    | read | Флаг: прочитана или нет книга | boolean |
    | id | Уникальный идентификатор записи о книге | integer |
    | created_at | Дата создания записи о книге | datatime |
    | owner_id | Уникальный идентификатор пользователя, запостившего книгу | integer |
    | owner_id/id | Уникальный идентификатор пользователя, запостившего книгу | integer |
    | owner_id/email | Емейл пользователя, запостившего книгу | string |

- Неуспешная обработка запроса:
    - Отсутствует запись с указанным id        
        Код ответа - 404 Not Found        
        И  объект в формате json с указанием на ошибку
        ```json
        {
            "detail": "book with id {id} was not found"
        }
        ```
    - Пользователь не авторизован или токен авторизации истек
        Код ответа - 403 Forbidden        
        И  объект в формате json с указанием на ошибку
        ```json
        {
            "detail": "Not authorized to perform requested action"
        }
        ```
    - Не переданы обязательные параметры или переданы некорректные значения        
        Код ответа - 422 Unprocessable Entity        
        И  объект в формате json с указанием на ошибку


---





